const e=require("commander"),n=new e.Command;n.option("-d --debug").option("-c --config [config]").option("--no-clean").parse(process.argv);var t=n.debug,s=process.VIEWS;const o=process.isRes,r=require("fs"),i=require("path"),c=r.readFileSync(i.resolve(process.env.INIT_CWD,"public/pages/index.html"),"utf-8").split("\n"),p=c.map(e=>{var n=e.match(/(?<=<)\w+/);if(null!==n)return{tag:n[0],...(e.match(/\w+="[^"]*"/g)||[]).reduce((e,n)=>{let t=n.split("="),s=t[0],o=t[1].replace(/"/g,"");return e[s]=o,e},{})}}).filter(Boolean);var a=p.filter(e=>{const{tag:n,src:t}=e;return"script"===n&&t&&!t.includes("/pages/js")&&!t.includes("requirejs")}).map(e=>(o&&(e.src=`..${e.src}`),e)).concat(["https://cdn.jsdelivr.net/npm/react@16.13.1/umd/react.production.min.js","https://cdn.jsdelivr.net/npm/react-dom@16.8.0/umd/react-dom.production.min.js","https://cdn.jsdelivr.net/npm/vue-template-compiler@2.6.11/browser.min.js","https://cdn.jsdelivr.net/npm/prismjs@1.20.0/prism.min.js","https://cdn.jsdelivr.net/npm/jss@10.3.0/dist/jss.min.js","https://cdn.jsdelivr.net/npm/acorn@7.3.1/dist/acorn.js","https://cdn.jsdelivr.net/npm/buble@0.20.0/dist/buble-browser-deps.umd.js","https://cdn.bootcdn.net/ajax/libs/require.js/2.3.6/require.js"].map(e=>({tag:"script",src:e}))),l=p.filter(e=>{const{tag:n,href:t}=e;return"link"===n||t&&!t.includes("/pages/js")});const m=function(e){return/\.(vue|js)$/.test(e)||(e+="/index.js"),e="."!==e[0]&&!e.includes("node_modules")?"node_modules/"+e:e},d=function(t,e){return Object.values(t).every(e=>"string"==typeof e)?{name:e,sectionDepth:99,components:Object.values(t).map(m)}:(Object.entries(t).map(([e,n])=>{t["其他示例"]||(t["其他示例"]={}),"string"==typeof n&&(t["其他示例"][e]=n,delete t[e])}),{name:e,sectionDepth:99,sections:Object.entries(t).filter(([,e])=>"{}"!==JSON.stringify(e)).map(([e,n])=>d(n,e))})};s=d(s);t&&console.log("compsSections[示例组件]",s),module.exports={title:process.env.npm_package_name,version:"v"+process.env.npm_package_version,assetsDir:"public",styleguideDir:"public/help",template:{head:{scripts:a,links:l}},getExampleFilename(e){return e.replace("components","vue-styleguidist-example").replace(/\.vue?$/,".md")},serverPort:6066,components:s.components,sections:s.sections,pagePerSection:!0,exampleMode:"collapse",tocMode:"expand",usageMode:"expand",dangerouslyUpdateWebpackConfig:e=>{e.externals&&(e.externals=[e.externals,{react:"React","react-dom":"ReactDOM","vue-template-compiler":"VueTemplateCompiler",prismjs:"Prism",jss:"jss",acorn:"acorn",buble:"buble"},function(e,n,t){n=n.match(/lodash\/(.+)/);if(n)return t(null,["_",n[1]]);t()}]),e.plugins=e.plugins.filter(e=>!["CopyPlugin","PreloadPlugin","HtmlWebpackPlugin"].includes(e.constructor.name));const t=/vue-cli-plugin-vogter[\\/]components/;return e.module.rules.forEach(n=>{(n.use||[]).forEach(({loader:e})=>{e.includes("eslint-loader")&&n.exclude.push(t),e.includes("babel-loader")&&n.exclude.push(t)}),e.module.rules.push({test:/\.m?jsx?$/,include:t,use:[{loader:"babel-loader",options:{configFile:i.resolve(__dirname,"./components/babel.config.js")}}]})}),e},renderRootJsx:i.join(__dirname,"components/Root.js"),styleguideComponents:{"ReactComponent/ReactComponent":i.join(__dirname,"components/ReactComponent"),ComponentsListRenderer:i.join(__dirname,"components/ComponentsListRenderer"),TableOfContentsRenderer:i.join(__dirname,"components/TableOfContentsRenderer"),StyleGuideRenderer:i.join(__dirname,"components/StyleGuideRenderer"),Link:i.join(__dirname,"components/Link"),TabButton:i.join(__dirname,"components/TabButton"),ToolbarButton:i.join(__dirname,"components/ToolbarButton"),Arguments:i.join(__dirname,"components/ArgumentsRenderer")}};